"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8479],{39903:function(e,t,r){r.d(t,{aI:function(){return g}});var n,i,o,a,s=r(67294),l=r(83329),u=r(10342),c=r(72812),d=r(35138);async function f(e,t,r,n){let i;let o=(0,d.VJ)({repoId:e});try{if((0,l.pD)().apiUrl){var a;i=await (a={access_token:null!=t?t:"wiki_public_access_only",repo_url:o.repoUrl,iteration:r,diagrams:n},(0,l.jU)("/FEATURE_WORKER",void 0)({feature:"auto_wiki_get",...a}))}else{let t=await fetch("/api/cached-wikis/".concat(e,".json"));if(!t.ok)return null;i=await t.json()}}catch(e){if(e instanceof Error&&("error: Wiki does not exist."===e.message||e.message.startsWith("server internal error: Could not get default branch for ")))return null;throw e}return i.wiki?i.wiki_json?{...JSON.parse(i.wiki_json),text:i.wiki,version:i.version,iteration:i.iteration||0,latest_iteration:i.latest_iteration||0}:(console.warn("Wiki response is missing `wiki_json` field.",e),null):(console.warn("Wiki response is missing `wiki` field.",e),null)}async function h(e){return p(await (0,l.jU)("/FEATURE_WORKER")({feature:"auto_wiki_task_check",...e}))}function p(e){if("dry-run-success"===e.status)return{...e,status:"not found"};if("failed"===e.status&&"duplicating tasks"===e.message)return{...e,status:"pending"};if("failed"===e.status)return e;throw Error("Invalid auto wiki task check response: "+JSON.stringify(e))}(n=o||(o={})).STANDUP="standup",n.SUMMARY="summary",n.BUGS="bugs",n.WIKI="wiki",(i=a||(a={})).DAILY="daily",i.HOURLY="hourly",i.ONE_OFF="one-off";var v=r(9763);let k=new Map;async function _(e,t){var r,n,i,o;let a,s,u,c;function d(){return[[a,s],[u,c]]}if(null===(r=t.debugValues)||void 0===r?void 0:r.forceEmptyState)return a=null,u=t.debugValues.forceEmptyState.generationState,d();try{let r=null!==(i=null===(n=t.auth)||void 0===n?void 0:n.credentials)&&void 0!==i?i:"wiki_public_access_only";a=await f(e,r,t.iteration,t.diagrams)}catch(e){return a=null,s=e,d()}if(a);else if((0,l.pD)().apiUrl){let r,n;try{[r,n]=await t.checkAutoWikiGeneration(e)}catch(e){return u="error-check-crashed",c=e,d()}u=n&&("pending"===n.status||"running"===n.status)?"generating":n&&"failed"===n.status?"error-failed":null==r?"error-not-logged-in":(null===(o=t.auth)||void 0===o?void 0:o.user)?!1===r?"error-repo-not-found":"invalid-auth"===r?"error-invalid-auth":n?"not found"===n.status?r.is_public?"can-generate-and-public":"can-generate-and-private":"failed"===n.status?"error-repo-not-found":"error-check-crashed":"error-check-crashed":!1!==r?"error-not-logged-in-and-public":"error-not-logged-in-and-not-found"}else u="error-check-crashed";return d()}function g(e,t,r,n,i){var f;let g=(0,s.useRef)(),[w,m]=(0,s.useState)([[void 0,void 0],[void 0,void 0]]),[[,E],[,y]]=w,b=(0,u.E)(),Z=(0,c.Y)(),U=function(){let e=(0,u.E)(),t=null==e?void 0:e.user,r=null==e?void 0:e.credentials,n=null==t?void 0:t.email;return(0,s.useEffect)(()=>{k.clear()},[r,n]),async function(t){var i,s,u,c;let f=(0,d.VJ)({repoId:t}),_=k.get(t);if(null==_){let e;try{e=await (i={access_token:r,repo_url:f.repoUrl},(0,l.jU)("/FEATURE_WORKER",void 0)({feature:"check_user_can_access_repo",...i})),_="error"!==e.status&&e}catch(e){if(e instanceof Error&&e.message.startsWith("server internal error: 1 validation error for BodyData\naccess_token"))_=void 0;else if(e instanceof Error&&"error: Repo does not exist."===e.message)_=!1;else if(e instanceof Error&&"error: Invalid access token"===e.message)_="invalid-auth";else throw e}k.set(t,_)}let g=(0,v.Z)(),w=g?{api_key:g,user_id:"unauthed-user@enterprise-mode.invalid"}:r&&n?{access_token:r,user_id:n}:void 0;if("invalid-auth"===_||(!1===_||g||await (s={repo_url:f.repoUrl,is_update:"true",user_id:t.split("/")[0],metadata_only:!0},(0,l.jU)("/REPO")(s)).catch(()=>{}),!w))return[_,void 0];if(!1!==_){let t;if(g)try{t=await h({repo_url:f.repoUrl,access_token:null!==(u=null==e?void 0:e.credentials)&&void 0!==u?u:g})}catch(e){console.warn("Error checking generation status",e)}else t=p(await (c={...w,task_category:o.WIKI,repo_url:f.repoUrl,frequency:a.ONE_OFF,dry_run:!0},(0,l.jU)("/TASK_PUBLISHER")(c)));return[_,t]}return[_,void 0]}}();return((0,s.useEffect)(()=>{(Z.values.forceEmptyState||t)&&e&&(!b||!b.isLoading)&&(m([[void 0,void 0],[void 0,void 0]]),_(e,{auth:b,iteration:n,diagrams:i,debugValues:Z.values,checkAutoWikiGeneration:U}).then(t=>{g.current=e,m(t)}).catch(e=>{throw e}))},[t,!!Z.values.forceEmptyState,null===(f=Z.values.forceEmptyState)||void 0===f?void 0:f.generationState,e,n,null==b?void 0:b.isLoading,null==b?void 0:b.credentials,...r]),(0,s.useEffect)(()=>{!function(e){let[[,t],[,r]]=e;t&&console.warn("Error while fetching wiki:",t),r&&console.warn("Error while checking generation state:",r)}(w)},[E,y]),e!==g.current)?[[void 0,void 0],[void 0,void 0]]:w}},63417:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(35944),i=r(86204),o=r(77942),a=r(77518),s=r(57606);function l(e){let t=(0,s.H)({hasHost:!0}),r=!1;try{new URL(e.href),r=!0}catch(e){}let l=(0,n.BX)(o.Z,{size:"16-14",inline:e.inline,children:["github"===t.hostType?(0,n.tZ)(i.hJX,{className:"align-text-bottom"}):(0,n.tZ)(i.tvD,{className:"align-text-bottom"})," ",(0,n.tZ)("span",{"data-link-decoration":"",children:e.repoId})]});return r?(0,n.tZ)("a",{target:"_blank",href:e.href,"data-no-decoration":"",children:l}):(0,n.tZ)(a.Z,{href:e.href,"data-no-decoration":"",children:l})}},924:function(e,t,r){r.d(t,{Z:function(){return c}});var n=r(82729),i=r(35944),o=r(18872),a=r(86204),s=r(77942),l=r(14292);function u(){let e=(0,n._)(["\n        opacity: 0.5;\n      "]);return u=function(){return e},e}function c(e){return(0,i.BX)("span",{className:(0,o.iv)(u()),children:[e.text,null!=e.popOver&&(0,i.tZ)(l.Z,{text:e.popOver,children:(0,i.tZ)(s.Z,{inline:!0,size:"16-14",children:(0,i.tZ)(a.GWH,{className:"ml-1 cursor-pointer"})})})]})}},38899:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(35944),i=r(924);function o(){return(0,n.tZ)(i.Z,{text:"Auto Wiki permissions follow repository permissions.",popOver:(0,n.BX)(n.HY,{children:["Auto Wikis for public repositories are public.",(0,n.tZ)("br",{}),(0,n.tZ)("br",{}),"Auto Wikis for private repositories can only be viewed by those with access to the repository."]})})}},42091:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(31486),i=r.n(n);let o={"":1,k:1e3,m:1e6,b:1e9},a=new(i()).Scale(o);function s(e){let t="number"==typeof e||null==e?e:e.value;if(null==t)return t;let r=o.k<=t&&t<10*o.k||o.m<=t&&t<10*o.m||o.b<=t&&t<10*o.b?1:0;return i()(t,{separator:"",scale:a,decimals:r})}},14292:function(e,t,r){r.d(t,{Z:function(){return c}});var n=r(82729),i=r(35944),o=r(18872),a=r(96217),s=r(67294),l=r(41782);function u(){let e=(0,n._)(["\n            padding: 0 10px;\n            font-size: small;\n            max-width: 40ch;\n          "]);return u=function(){return e},e}function c(e){let[t,r]=(0,s.useState)(null),n=()=>{r(null)};return null==e.text?e.children:(0,i.BX)(i.HY,{children:[(0,i.tZ)("span",{"aria-haspopup":"true",onMouseEnter:e=>{r(e.currentTarget)},onMouseLeave:n,children:e.children}),(0,i.tZ)(a.ZP,{sx:{pointerEvents:"none"},open:!!t,anchorEl:t,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},disableScrollLock:!0,onClose:n,disableRestoreFocus:!0,children:(0,i.tZ)("p",{className:(0,o.iv)(u()),children:(0,i.tZ)(l.ZP,{children:e.text})})})]})}}}]);